{"version":3,"file":"ec9de763.js","sources":["../../../node_modules/@shopify/hydrogen/dist/esnext/utilities/isBrowser/isBrowser.js","../../../node_modules/@shopify/hydrogen/dist/esnext/hooks/useProductOptions/useProductOptions.client.js","../../../node_modules/@shopify/hydrogen/dist/esnext/components/AddToCartButton/AddToCartButton.client.js","../../../src/components/product/ProductForm.client.jsx","../../../src/components/product/ProductOptions.client.jsx"],"sourcesContent":["/** The `isClient` utility is a function that returns a boolean indicating\n * if the code was run in the browser.\n */\nexport function isBrowser() {\n    return typeof document !== 'undefined';\n}\n","import { useContext } from 'react';\nimport { ProductOptionsContext } from '../../components/ProductOptionsProvider/context.js';\nexport function useProductOptions() {\n    const context = useContext(ProductOptionsContext);\n    if (!context) {\n        throw new Error(`'useProductOptions' must be a child of <ProductOptionsProvider/>`);\n    }\n    return context;\n}\n","import React, { useCallback, useEffect, useState } from 'react';\nimport { useCart } from '../CartProvider/index.js';\nimport { useProductOptions } from '../../hooks/useProductOptions/index.js';\nimport { BaseButton } from '../BaseButton/index.js';\n/**\n * The `AddToCartButton` component renders a button that adds an item to the cart when pressed.\n * It must be a descendent of the `CartProvider` component.\n */\nexport function AddToCartButton(props) {\n    const [addingItem, setAddingItem] = useState(false);\n    const { variantId: explicitVariantId, quantity = 1, attributes, sellingPlanId, onClick, children, accessibleAddingToCartLabel, ...passthroughProps } = props;\n    const { status, linesAdd } = useCart();\n    const { selectedVariant } = useProductOptions();\n    const variantId = explicitVariantId ?? selectedVariant?.id ?? '';\n    const disabled = explicitVariantId === null ||\n        variantId === '' ||\n        selectedVariant === null ||\n        addingItem ||\n        passthroughProps.disabled;\n    useEffect(() => {\n        if (addingItem && status === 'idle') {\n            setAddingItem(false);\n        }\n    }, [status, addingItem]);\n    const handleAddItem = useCallback(() => {\n        setAddingItem(true);\n        linesAdd([\n            {\n                quantity,\n                merchandiseId: variantId,\n                attributes,\n                sellingPlanId,\n            },\n        ]);\n    }, [linesAdd, quantity, variantId, attributes, sellingPlanId]);\n    return (React.createElement(React.Fragment, null,\n        React.createElement(BaseButton, { ...passthroughProps, disabled: disabled, onClick: onClick, defaultOnClick: handleAddItem }, children),\n        accessibleAddingToCartLabel ? (React.createElement(\"p\", { style: {\n                position: 'absolute',\n                width: '1px',\n                height: '1px',\n                padding: '0',\n                margin: '-1px',\n                overflow: 'hidden',\n                clip: 'rect(0, 0, 0, 0)',\n                whiteSpace: 'nowrap',\n                borderWidth: '0',\n            }, role: \"alert\", \"aria-live\": \"assertive\" }, addingItem ? accessibleAddingToCartLabel : null)) : null));\n}\n","import {useEffect, useCallback, useState} from 'react';\n\nimport {\n  useProductOptions,\n  isBrowser,\n  useUrl,\n  AddToCartButton,\n  Money,\n  ShopPayButton,\n} from '@shopify/hydrogen';\n\nimport {Heading, Text, Button, ProductOptions} from '~/components';\n\nexport function ProductForm() {\n  const {pathname, search} = useUrl();\n  const [params, setParams] = useState(new URLSearchParams(search));\n\n  const {options, setSelectedOption, selectedOptions, selectedVariant} =\n    useProductOptions();\n\n  const isOutOfStock = !selectedVariant?.availableForSale || false;\n  const isOnSale =\n    selectedVariant?.priceV2?.amount <\n      selectedVariant?.compareAtPriceV2?.amount || false;\n\n  useEffect(() => {\n    if (params || !search) return;\n    setParams(new URLSearchParams(search));\n  }, [params, search]);\n\n  useEffect(() => {\n    options.map(({name, values}) => {\n      if (!params) return;\n      const currentValue = params.get(name.toLowerCase()) || null;\n      if (currentValue) {\n        const matchedValue = values.filter(\n          (value) => encodeURIComponent(value.toLowerCase()) === currentValue,\n        );\n        setSelectedOption(name, matchedValue[0]);\n      } else {\n        params.set(\n          encodeURIComponent(name.toLowerCase()),\n          encodeURIComponent(selectedOptions[name].toLowerCase()),\n        ),\n          window.history.replaceState(\n            null,\n            '',\n            `${pathname}?${params.toString()}`,\n          );\n      }\n    });\n  }, []);\n\n  const handleChange = useCallback(\n    (name, value) => {\n      setSelectedOption(name, value);\n      if (!params) return;\n      params.set(\n        encodeURIComponent(name.toLowerCase()),\n        encodeURIComponent(value.toLowerCase()),\n      );\n      if (isBrowser()) {\n        window.history.replaceState(\n          null,\n          '',\n          `${pathname}?${params.toString()}`,\n        );\n      }\n    },\n    [setSelectedOption, params, pathname],\n  );\n\n  return (\n    <form className=\"grid gap-10\">\n      {\n        <div className=\"grid gap-4\">\n          {options.map(({name, values}) => {\n            if (values.length === 1) {\n              return null;\n            }\n            return (\n              <div\n                key={name}\n                className=\"flex flex-col flex-wrap mb-4 gap-y-2 last:mb-0\"\n              >\n                <Heading as=\"legend\" size=\"lead\" className=\"min-w-[4rem]\">\n                  {name}\n                </Heading>\n                <div className=\"flex flex-wrap items-baseline gap-4\">\n                  <ProductOptions\n                    name={name}\n                    handleChange={handleChange}\n                    values={values}\n                  />\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      }\n      <div className=\"grid items-stretch gap-4\">\n        <AddToCartButton\n          variantId={selectedVariant?.id}\n          quantity={1}\n          accessibleAddingToCartLabel=\"Adding item to your cart\"\n          disabled={isOutOfStock}\n          type=\"button\"\n        >\n          <Button\n            width=\"full\"\n            variant={isOutOfStock ? 'secondary' : 'primary'}\n            as=\"span\"\n          >\n            {isOutOfStock ? (\n              <Text>Sold out</Text>\n            ) : (\n              <Text\n                as=\"span\"\n                className=\"flex items-center justify-center gap-2\"\n              >\n                <span>Add to bag</span> <span>Â·</span>{' '}\n                <Money\n                  withoutTrailingZeros\n                  data={selectedVariant.priceV2}\n                  as=\"span\"\n                />\n                {isOnSale && (\n                  <Money\n                    withoutTrailingZeros\n                    data={selectedVariant.compareAtPriceV2}\n                    as=\"span\"\n                    className=\"opacity-50 strike\"\n                  />\n                )}\n              </Text>\n            )}\n          </Button>\n        </AddToCartButton>\n        {!isOutOfStock && <ShopPayButton variantIds={[selectedVariant.id]} />}\n      </div>\n    </form>\n  );\n}\n","import {useCallback, useState} from 'react';\n// @ts-expect-error @headlessui/react incompatibility with node16 resolution\nimport {Listbox} from '@headlessui/react';\nimport {useProductOptions} from '@shopify/hydrogen';\n\nimport {Text, IconCheck, IconCaret} from '~/components';\n\nexport function ProductOptions({values, ...props}) {\n  const asDropdown = values.length > 7;\n\n  return asDropdown ? (\n    <OptionsDropdown values={values} {...props} />\n  ) : (\n    <OptionsGrid values={values} {...props} />\n  );\n}\n\nfunction OptionsGrid({values, name, handleChange}) {\n  const {selectedOptions} = useProductOptions();\n\n  return (\n    <>\n      {values.map((value) => {\n        const checked = selectedOptions[name] === value;\n        const id = `option-${name}-${value}`;\n\n        return (\n          <Text as=\"label\" key={id} htmlFor={id}>\n            <input\n              className=\"sr-only\"\n              type=\"radio\"\n              id={id}\n              name={`option[${name}]`}\n              value={value}\n              checked={checked}\n              onChange={() => handleChange(name, value)}\n            />\n            <div\n              className={`leading-none py-1 border-b-[1.5px] cursor-pointer transition-all duration-200 ${\n                checked ? 'border-primary/50' : 'border-primary/0'\n              }`}\n            >\n              {value}\n            </div>\n          </Text>\n        );\n      })}\n    </>\n  );\n}\n\n// TODO: De-dupe UI with CountrySelector\nfunction OptionsDropdown({values, name, handleChange}) {\n  const [listboxOpen, setListboxOpen] = useState(false);\n  const {selectedOptions} = useProductOptions();\n\n  const updateSelectedOption = useCallback(\n    (value) => {\n      handleChange(name, value);\n    },\n    [name, handleChange],\n  );\n\n  return (\n    <div className=\"relative w-full\">\n      <Listbox onChange={updateSelectedOption} value=\"\">\n        {/* @ts-expect-error @headlessui/react incompatibility with node16 resolution */}\n        {({open}) => {\n          setTimeout(() => setListboxOpen(open));\n          return (\n            <>\n              <Listbox.Button\n                className={`flex items-center justify-between w-full py-3 px-4 border border-primary ${\n                  open ? 'rounded-b md:rounded-t md:rounded-b-none' : 'rounded'\n                }`}\n              >\n                <span>{selectedOptions[name]}</span>\n                <IconCaret direction={open ? 'up' : 'down'} />\n              </Listbox.Button>\n\n              <Listbox.Options\n                className={`border-primary bg-contrast absolute bottom-12 z-30 grid\n                h-48 w-full overflow-y-scroll rounded-t border px-2 py-2 transition-[max-height]\n                duration-150 sm:bottom-auto md:rounded-b md:rounded-t-none md:border-t-0 md:border-b ${\n                  listboxOpen ? 'max-h-48' : 'max-h-0'\n                }`}\n              >\n                {values.map((value) => {\n                  const isSelected = selectedOptions[name] === value;\n                  const id = `option-${name}-${value}`;\n\n                  return (\n                    <Listbox.Option key={id} value={value}>\n                      {/* @ts-expect-error @headlessui/react incompatibility with node16 resolution */}\n                      {({active}) => (\n                        <div\n                          className={`text-primary w-full p-2 transition rounded flex justify-start items-center text-left cursor-pointer ${\n                            active ? 'bg-primary/10' : null\n                          }`}\n                        >\n                          {value}\n                          {isSelected ? (\n                            <span className=\"ml-2\">\n                              <IconCheck />\n                            </span>\n                          ) : null}\n                        </div>\n                      )}\n                    </Listbox.Option>\n                  );\n                })}\n              </Listbox.Options>\n            </>\n          );\n        }}\n      </Listbox>\n    </div>\n  );\n}\n"],"names":["isBrowser","useProductOptions","context","useContext","ProductOptionsContext","AddToCartButton","props","addingItem","setAddingItem","useState","variantId","explicitVariantId","quantity","attributes","sellingPlanId","onClick","children","accessibleAddingToCartLabel","passthroughProps","status","linesAdd","useCart","selectedVariant","id","disabled","useEffect","handleAddItem","useCallback","merchandiseId","_jsxs","_Fragment","_jsx","BaseButton","position","width","height","padding","margin","overflow","clip","whiteSpace","borderWidth","ProductForm","pathname","search","useUrl","params","setParams","URLSearchParams","options","setSelectedOption","selectedOptions","isOutOfStock","availableForSale","isOnSale","priceV2","amount","compareAtPriceV2","map","name","values","currentValue","get","toLowerCase","matchedValue","filter","value","encodeURIComponent","set","window","history","replaceState","toString","handleChange","length","Heading","ProductOptions","Button","Text","Money","ShopPayButton","asDropdown","OptionsDropdown","OptionsGrid","checked","listboxOpen","setListboxOpen","updateSelectedOption","Listbox","open","IconCaret","isSelected","active","IconCheck"],"mappings":"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"}