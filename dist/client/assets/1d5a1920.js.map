{"version":3,"file":"1d5a1920.js","sources":["../../../src/components/account/AccountDetailsEdit.client.jsx","../../../src/components/account/AccountDetails.client.jsx"],"sourcesContent":["import {useState} from 'react';\n\nimport {Text, Button} from '~/components';\nimport {\n  emailValidation,\n  passwordValidation,\n  useRenderServerComponents,\n} from '~/lib/utils';\nimport {getInputStyleClasses} from '../../lib/styleUtils';\n\nexport function AccountDetailsEdit({\n  firstName: _firstName = '',\n  lastName: _lastName = '',\n  phone: _phone = '',\n  email: _email = '',\n  close,\n}) {\n  const [saving, setSaving] = useState(false);\n  const [firstName, setFirstName] = useState(_firstName);\n  const [lastName, setLastName] = useState(_lastName);\n  const [phone, setPhone] = useState(_phone);\n  const [email, setEmail] = useState(_email);\n  const [emailError, setEmailError] = useState(null);\n  const [currentPasswordError, setCurrentPasswordError] = useState(null);\n  const [newPasswordError, setNewPasswordError] = useState(null);\n  const [newPassword2Error, setNewPassword2Error] = useState(null);\n  const [submitError, setSubmitError] = useState(null);\n\n  // Necessary for edits to show up on the main page\n  const renderServerComponents = useRenderServerComponents();\n\n  async function onSubmit(event) {\n    event.preventDefault();\n\n    setEmailError(null);\n    setCurrentPasswordError(null);\n    setNewPasswordError(null);\n    setNewPassword2Error(null);\n\n    const emailError = emailValidation(event.currentTarget.email);\n    if (emailError) {\n      setEmailError(emailError);\n    }\n\n    let currentPasswordError, newPasswordError, newPassword2Error;\n\n    // Only validate the password fields if the current password has a value\n    if (event.currentTarget.currentPassword.value) {\n      currentPasswordError = passwordValidation(\n        event.currentTarget.currentPassword,\n      );\n      if (currentPasswordError) {\n        setCurrentPasswordError(currentPasswordError);\n      }\n\n      newPasswordError = passwordValidation(event.currentTarget.newPassword);\n      if (newPasswordError) {\n        setNewPasswordError(newPasswordError);\n      }\n\n      newPassword2Error =\n        event.currentTarget.newPassword.value !==\n        event.currentTarget.newPassword2.value\n          ? 'The two passwords entered did not match'\n          : null;\n      if (newPassword2Error) {\n        setNewPassword2Error(newPassword2Error);\n      }\n    }\n\n    if (\n      emailError ||\n      currentPasswordError ||\n      newPasswordError ||\n      newPassword2Error\n    ) {\n      return;\n    }\n\n    setSaving(true);\n\n    const accountUpdateResponse = await callAccountUpdateApi({\n      email,\n      newPassword: event.currentTarget.newPassword.value,\n      currentPassword: event.currentTarget.currentPassword.value,\n      phone,\n      firstName,\n      lastName,\n    });\n\n    setSaving(false);\n\n    if (accountUpdateResponse.error) {\n      setSubmitError(accountUpdateResponse.error);\n      return;\n    }\n\n    renderServerComponents();\n    close();\n  }\n\n  return (\n    <>\n      <Text className=\"mt-4 mb-6\" as=\"h3\" size=\"lead\">\n        Update your profile\n      </Text>\n      <form noValidate onSubmit={onSubmit}>\n        {submitError && (\n          <div className=\"flex items-center justify-center mb-6 bg-red-100 rounded\">\n            <p className=\"m-4 text-sm text-red-900\">{submitError}</p>\n          </div>\n        )}\n        <div className=\"mt-3\">\n          <input\n            className={getInputStyleClasses()}\n            id=\"firstname\"\n            name=\"firstname\"\n            type=\"text\"\n            autoComplete=\"given-name\"\n            placeholder=\"First name\"\n            aria-label=\"First name\"\n            value={firstName}\n            onChange={(event) => {\n              setFirstName(event.target.value);\n            }}\n          />\n        </div>\n        <div className=\"mt-3\">\n          <input\n            className={getInputStyleClasses()}\n            id=\"lastname\"\n            name=\"lastname\"\n            type=\"text\"\n            autoComplete=\"family-name\"\n            placeholder=\"Last name\"\n            aria-label=\"Last name\"\n            value={lastName}\n            onChange={(event) => {\n              setLastName(event.target.value);\n            }}\n          />\n        </div>\n        <div className=\"mt-3\">\n          <input\n            className={getInputStyleClasses()}\n            id=\"phone\"\n            name=\"phone\"\n            type=\"tel\"\n            autoComplete=\"tel\"\n            placeholder=\"Mobile\"\n            aria-label=\"Mobile\"\n            value={phone}\n            onChange={(event) => {\n              setPhone(event.target.value);\n            }}\n          />\n        </div>\n        <div className=\"mt-3\">\n          <input\n            className={getInputStyleClasses(emailError)}\n            id=\"email\"\n            name=\"email\"\n            type=\"email\"\n            autoComplete=\"email\"\n            required\n            placeholder=\"Email address\"\n            aria-label=\"Email address\"\n            value={email}\n            onChange={(event) => {\n              setEmail(event.target.value);\n            }}\n          />\n          <p\n            className={`text-red-500 text-xs ${!emailError ? 'invisible' : ''}`}\n          >\n            {emailError} &nbsp;\n          </p>\n        </div>\n        <Text className=\"mb-6 mt-6\" as=\"h3\" size=\"lead\">\n          Change your password\n        </Text>\n        <Password\n          name=\"currentPassword\"\n          label=\"Current password\"\n          passwordError={currentPasswordError}\n        />\n        <Password\n          name=\"newPassword\"\n          label=\"New password\"\n          passwordError={newPasswordError}\n        />\n        <Password\n          name=\"newPassword2\"\n          label=\"Re-enter new password\"\n          passwordError={newPassword2Error}\n        />\n        <Text\n          size=\"fine\"\n          color=\"subtle\"\n          className={`mt-1 ${\n            currentPasswordError || newPasswordError ? 'text-red-500' : ''\n          }`}\n        >\n          Passwords must be at least 6 characters.\n        </Text>\n        {newPassword2Error ? <br /> : null}\n        <Text\n          size=\"fine\"\n          className={`mt-1 text-red-500 ${\n            newPassword2Error ? '' : 'invisible'\n          }`}\n        >\n          {newPassword2Error} &nbsp;\n        </Text>\n        <div className=\"mt-6\">\n          <Button\n            className=\"text-sm mb-2\"\n            variant=\"primary\"\n            width=\"full\"\n            type=\"submit\"\n            disabled={saving}\n          >\n            Save\n          </Button>\n        </div>\n        <div className=\"mb-4\">\n          <Button\n            type=\"button\"\n            className=\"text-sm\"\n            variant=\"secondary\"\n            width=\"full\"\n            onClick={close}\n          >\n            Cancel\n          </Button>\n        </div>\n      </form>\n    </>\n  );\n}\n\nfunction Password({name, passwordError, label}) {\n  const [password, setPassword] = useState('');\n\n  return (\n    <div className=\"mt-3\">\n      <input\n        className={getInputStyleClasses(passwordError)}\n        id={name}\n        name={name}\n        type=\"password\"\n        autoComplete={\n          name === 'currentPassword' ? 'current-password' : undefined\n        }\n        placeholder={label}\n        aria-label={label}\n        value={password}\n        minLength={8}\n        required\n        onChange={(event) => {\n          setPassword(event.target.value);\n        }}\n      />\n    </div>\n  );\n}\n\nexport async function callAccountUpdateApi({\n  email,\n  phone,\n  firstName,\n  lastName,\n  currentPassword,\n  newPassword,\n}) {\n  try {\n    const res = await fetch(`/account`, {\n      method: 'PATCH',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        email,\n        phone,\n        firstName,\n        lastName,\n        currentPassword,\n        newPassword,\n      }),\n    });\n    if (res.ok) {\n      return {};\n    } else {\n      return res.json();\n    }\n  } catch (_e) {\n    return {\n      error: 'Error saving account. Please try again.',\n    };\n  }\n}\n","import {Seo} from '@shopify/hydrogen';\nimport {useState} from 'react';\nimport {Modal} from '../index';\nimport {AccountDetailsEdit} from './AccountDetailsEdit.client';\n\nexport function AccountDetails({firstName, lastName, phone, email}) {\n  const [isEditing, setIsEditing] = useState(false);\n\n  const close = () => setIsEditing(false);\n\n  return (\n    <>\n      {isEditing ? (\n        <Modal close={close}>\n          <Seo type=\"noindex\" data={{title: 'Account details'}} />\n          <AccountDetailsEdit\n            firstName={firstName}\n            lastName={lastName}\n            phone={phone}\n            email={email}\n            close={close}\n          />\n        </Modal>\n      ) : null}\n      <div className=\"grid w-full gap-4 p-4 py-6 md:gap-8 md:p-8 lg:p-12\">\n        <h3 className=\"font-bold text-lead\">Account Details</h3>\n        <div className=\"lg:p-8 p-6 border border-gray-200 rounded\">\n          <div className=\"flex\">\n            <h3 className=\"font-bold text-base flex-1\">Profile & Security</h3>\n            <button\n              className=\"underline text-sm font-normal\"\n              onClick={() => setIsEditing(true)}\n            >\n              Edit\n            </button>\n          </div>\n          <div className=\"mt-4 text-sm text-primary/50\">Name</div>\n          <p className=\"mt-1\">\n            {firstName || lastName\n              ? (firstName ? firstName + ' ' : '') + lastName\n              : 'Add name'}{' '}\n          </p>\n\n          <div className=\"mt-4 text-sm text-primary/50\">Contact</div>\n          <p className=\"mt-1\">{phone ?? 'Add mobile'}</p>\n\n          <div className=\"mt-4 text-sm text-primary/50\">Email address</div>\n          <p className=\"mt-1\">{email}</p>\n\n          <div className=\"mt-4 text-sm text-primary/50\">Password</div>\n          <p className=\"mt-1\">**************</p>\n        </div>\n      </div>\n    </>\n  );\n}\n"],"names":["AccountDetailsEdit","firstName","_firstName","lastName","_lastName","phone","_phone","email","_email","close","saving","setSaving","useState","setFirstName","setLastName","setPhone","setEmail","emailError","setEmailError","currentPasswordError","setCurrentPasswordError","newPasswordError","setNewPasswordError","newPassword2Error","setNewPassword2Error","submitError","setSubmitError","renderServerComponents","useRenderServerComponents","onSubmit","event","preventDefault","emailValidation","currentTarget","currentPassword","value","passwordValidation","newPassword","newPassword2","accountUpdateResponse","callAccountUpdateApi","error","_Fragment","_jsx","Text","_jsxs","getInputStyleClasses","target","Password","Button","name","passwordError","label","password","setPassword","undefined","res","fetch","method","headers","Accept","body","JSON","stringify","ok","json","AccountDetails","isEditing","setIsEditing","Modal","Seo","title"],"mappings":"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"}