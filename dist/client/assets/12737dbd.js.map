{"version":3,"file":"12737dbd.js","sources":["../../../src/components/account/AccountLoginForm.client.jsx"],"sourcesContent":["import {useState} from 'react';\nimport {useNavigate, Link} from '@shopify/hydrogen/client';\nimport {getInputStyleClasses} from '../../lib/styleUtils';\n\nexport function AccountLoginForm({shopName}) {\n  const navigate = useNavigate();\n\n  const [hasSubmitError, setHasSubmitError] = useState(false);\n  const [showEmailField, setShowEmailField] = useState(true);\n  const [email, setEmail] = useState('');\n  const [emailError, setEmailError] = useState(null);\n  const [password, setPassword] = useState('');\n  const [passwordError, setPasswordError] = useState(null);\n\n  function onSubmit(event) {\n    event.preventDefault();\n\n    setEmailError(null);\n    setHasSubmitError(false);\n    setPasswordError(null);\n\n    if (showEmailField) {\n      checkEmail(event);\n    } else {\n      checkPassword(event);\n    }\n  }\n\n  function checkEmail(event) {\n    if (event.currentTarget.email.validity.valid) {\n      setShowEmailField(false);\n    } else {\n      setEmailError('Please enter a valid email');\n    }\n  }\n\n  async function checkPassword(event) {\n    const validity = event.currentTarget.password.validity;\n    if (validity.valid) {\n      const response = await callLoginApi({\n        email,\n        password,\n      });\n\n      if (response.error) {\n        setHasSubmitError(true);\n        resetForm();\n      } else {\n        navigate('/account');\n      }\n    } else {\n      setPasswordError(\n        validity.valueMissing\n          ? 'Please enter a password'\n          : 'Passwords must be at least 6 characters',\n      );\n    }\n  }\n\n  function resetForm() {\n    setShowEmailField(true);\n    setEmail('');\n    setEmailError(null);\n    setPassword('');\n    setPasswordError(null);\n  }\n\n  return (\n    <div className=\"flex justify-center my-24 px-4\">\n      <div className=\"max-w-md w-full\">\n        <h1 className=\"text-4xl\">Sign in.</h1>\n        <form noValidate className=\"pt-6 pb-8 mt-4 mb-4\" onSubmit={onSubmit}>\n          {hasSubmitError && (\n            <div className=\"flex items-center justify-center mb-6 bg-zinc-500\">\n              <p className=\"m-4 text-s text-contrast\">\n                Sorry we did not recognize either your email or password. Please\n                try to sign in again or create a new account.\n              </p>\n            </div>\n          )}\n          {showEmailField && (\n            <EmailField\n              shopName={shopName}\n              email={email}\n              setEmail={setEmail}\n              emailError={emailError}\n            />\n          )}\n          {!showEmailField && (\n            <ValidEmail email={email} resetForm={resetForm} />\n          )}\n          {!showEmailField && (\n            <PasswordField\n              password={password}\n              setPassword={setPassword}\n              passwordError={passwordError}\n            />\n          )}\n        </form>\n      </div>\n    </div>\n  );\n}\n\nexport async function callLoginApi({email, password}) {\n  try {\n    const res = await fetch(`/account/login`, {\n      method: 'POST',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({email, password}),\n    });\n    if (res.ok) {\n      return {};\n    } else {\n      return res.json();\n    }\n  } catch (error) {\n    return {\n      error: error.toString(),\n    };\n  }\n}\n\nfunction EmailField({email, setEmail, emailError, shopName}) {\n  return (\n    <>\n      <div className=\"mb-3\">\n        <input\n          className={`mb-1 ${getInputStyleClasses(emailError)}`}\n          id=\"email\"\n          name=\"email\"\n          type=\"email\"\n          autoComplete=\"email\"\n          required\n          placeholder=\"Email address\"\n          aria-label=\"Email address\"\n          // eslint-disable-next-line jsx-a11y/no-autofocus\n          autoFocus\n          value={email}\n          onChange={(event) => {\n            setEmail(event.target.value);\n          }}\n        />\n        {!emailError ? (\n          ''\n        ) : (\n          <p className={`text-red-500 text-xs`}>{emailError} &nbsp;</p>\n        )}\n      </div>\n      <div className=\"flex items-center justify-between\">\n        <button\n          className=\"bg-primary rounded text-contrast py-2 px-4 focus:shadow-outline block w-full\"\n          type=\"submit\"\n        >\n          Next\n        </button>\n      </div>\n      <div className=\"flex items-center mt-8 border-t  border-gray-300\">\n        <p className=\"align-baseline text-sm mt-6\">\n          New to {shopName}? &nbsp;\n          <Link className=\"inline underline\" to=\"/account/register\">\n            Create an account\n          </Link>\n        </p>\n      </div>\n    </>\n  );\n}\n\nfunction ValidEmail({email, resetForm}) {\n  return (\n    <div className=\"mb-3 flex items-center justify-between\">\n      <div>\n        <p>{email}</p>\n        <input\n          className=\"hidden\"\n          type=\"text\"\n          autoComplete=\"username\"\n          value={email}\n          readOnly\n        ></input>\n      </div>\n      <div>\n        <button\n          className=\"inline-block align-baseline text-sm underline\"\n          type=\"button\"\n          onClick={resetForm}\n        >\n          Change email\n        </button>\n      </div>\n    </div>\n  );\n}\n\nfunction PasswordField({password, setPassword, passwordError}) {\n  return (\n    <>\n      <div className=\"mb-3\">\n        <input\n          className={`mb-1 ${getInputStyleClasses(passwordError)}`}\n          id=\"password\"\n          name=\"password\"\n          type=\"password\"\n          autoComplete=\"current-password\"\n          placeholder=\"Password\"\n          aria-label=\"Password\"\n          value={password}\n          minLength={8}\n          required\n          // eslint-disable-next-line jsx-a11y/no-autofocus\n          autoFocus\n          onChange={(event) => {\n            setPassword(event.target.value);\n          }}\n        />\n        {!passwordError ? (\n          ''\n        ) : (\n          <p className={`text-red-500 text-xs`}> {passwordError} &nbsp;</p>\n        )}\n      </div>\n      <div className=\"flex items-center justify-between\">\n        <button\n          className=\"bg-primary text-contrast rounded py-2 px-4 focus:shadow-outline block w-full\"\n          type=\"submit\"\n        >\n          Sign in\n        </button>\n      </div>\n      <div className=\"flex items-center justify-between mt-4\">\n        <div className=\"flex-1\"></div>\n        <Link\n          className=\"inline-block align-baseline text-sm text-primary/50\"\n          to=\"/account/recover\"\n        >\n          Forgot password\n        </Link>\n      </div>\n    </>\n  );\n}\n"],"names":["AccountLoginForm","shopName","navigate","useNavigate","hasSubmitError","setHasSubmitError","useState","showEmailField","setShowEmailField","email","setEmail","emailError","setEmailError","password","setPassword","passwordError","setPasswordError","onSubmit","event","preventDefault","checkEmail","checkPassword","currentTarget","validity","valid","callLoginApi","error","resetForm","valueMissing","_jsx","_jsxs","EmailField","ValidEmail","PasswordField","res","fetch","method","headers","Accept","body","JSON","stringify","ok","json","toString","_Fragment","getInputStyleClasses","target","value","Link"],"mappings":"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"}