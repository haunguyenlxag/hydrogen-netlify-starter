{"version":3,"file":"3f168d29.js","sources":["../../../src/components/account/AccountPasswordResetForm.client.jsx"],"sourcesContent":["import {useState} from 'react';\nimport {useNavigate} from '@shopify/hydrogen/client';\nimport {getInputStyleClasses} from '../../lib/styleUtils';\n\nexport function AccountPasswordResetForm({id, resetToken}) {\n  const navigate = useNavigate();\n\n  const [submitError, setSubmitError] = useState(null);\n  const [password, setPassword] = useState('');\n  const [passwordError, setPasswordError] = useState(null);\n  const [passwordConfirm, setPasswordConfirm] = useState('');\n  const [passwordConfirmError, setPasswordConfirmError] = useState(null);\n\n  function passwordValidation(form) {\n    setPasswordError(null);\n    setPasswordConfirmError(null);\n\n    let hasError = false;\n\n    if (!form.password.validity.valid) {\n      hasError = true;\n      setPasswordError(\n        form.password.validity.valueMissing\n          ? 'Please enter a password'\n          : 'Passwords must be at least 6 characters',\n      );\n    }\n\n    if (!form.passwordConfirm.validity.valid) {\n      hasError = true;\n      setPasswordConfirmError(\n        form.password.validity.valueMissing\n          ? 'Please re-enter a password'\n          : 'Passwords must be at least 6 characters',\n      );\n    }\n\n    if (password !== passwordConfirm) {\n      hasError = true;\n      setPasswordConfirmError('The two password entered did not match.');\n    }\n\n    return hasError;\n  }\n\n  async function onSubmit(event) {\n    event.preventDefault();\n\n    if (passwordValidation(event.currentTarget)) {\n      return;\n    }\n\n    const response = await callPasswordResetApi({\n      id,\n      resetToken,\n      password,\n    });\n\n    if (response.error) {\n      setSubmitError(response.error);\n      return;\n    }\n\n    navigate('/account');\n  }\n\n  return (\n    <div className=\"flex justify-center my-24 px-4\">\n      <div className=\"max-w-md w-full\">\n        <h1 className=\"text-4xl\">Reset Password.</h1>\n        <p className=\"mt-4\">Enter a new password for your account.</p>\n        <form noValidate className=\"pt-6 pb-8 mt-4 mb-4\" onSubmit={onSubmit}>\n          {submitError && (\n            <div className=\"flex items-center justify-center mb-6 bg-zinc-500\">\n              <p className=\"m-4 text-s text-contrast\">{submitError}</p>\n            </div>\n          )}\n          <div className=\"mb-3\">\n            <input\n              className={`mb-1 ${getInputStyleClasses(passwordError)}`}\n              id=\"password\"\n              name=\"password\"\n              type=\"password\"\n              autoComplete=\"current-password\"\n              placeholder=\"Password\"\n              aria-label=\"Password\"\n              // eslint-disable-next-line jsx-a11y/no-autofocus\n              autoFocus\n              value={password}\n              minLength={8}\n              required\n              onChange={(event) => {\n                setPassword(event.target.value);\n              }}\n            />\n            <p\n              className={`text-red-500 text-xs ${\n                !passwordError ? 'invisible' : ''\n              }`}\n            >\n              {passwordError} &nbsp;\n            </p>\n          </div>\n          <div className=\"mb-3\">\n            <input\n              className={`mb-1 ${getInputStyleClasses(passwordConfirmError)}`}\n              id=\"passwordConfirm\"\n              name=\"passwordConfirm\"\n              type=\"password\"\n              autoComplete=\"current-password\"\n              placeholder=\"Re-enter password\"\n              aria-label=\"Re-enter password\"\n              value={passwordConfirm}\n              required\n              minLength={8}\n              onChange={(event) => {\n                setPasswordConfirm(event.target.value);\n              }}\n            />\n            <p\n              className={`text-red-500 text-xs ${\n                !passwordConfirmError ? 'invisible' : ''\n              }`}\n            >\n              {passwordConfirmError} &nbsp;\n            </p>\n          </div>\n          <div className=\"flex items-center justify-between\">\n            <button\n              className=\"bg-primary text-contrast rounded py-2 px-4 focus:shadow-outline block w-full\"\n              type=\"submit\"\n            >\n              Save\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n\nexport async function callPasswordResetApi({id, resetToken, password}) {\n  try {\n    const res = await fetch(`/account/reset`, {\n      method: 'POST',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({id, resetToken, password}),\n    });\n\n    if (res.ok) {\n      return {};\n    } else {\n      return res.json();\n    }\n  } catch (error) {\n    return {\n      error: error.toString(),\n    };\n  }\n}\n"],"names":["AccountPasswordResetForm","id","resetToken","navigate","useNavigate","submitError","setSubmitError","useState","password","setPassword","passwordError","setPasswordError","passwordConfirm","setPasswordConfirm","passwordConfirmError","setPasswordConfirmError","passwordValidation","form","hasError","validity","valid","valueMissing","onSubmit","event","preventDefault","currentTarget","response","callPasswordResetApi","error","_jsx","_jsxs","getInputStyleClasses","target","value","res","fetch","method","headers","Accept","body","JSON","stringify","ok","json","toString"],"mappings":"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"}